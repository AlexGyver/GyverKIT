![License: MIT](https://img.shields.io/badge/License-MIT-green.svg)
![author](https://img.shields.io/badge/author-AlexGyver-informational.svg)
# microDS18B20
Легкая и удобная в обращении библиотека для работы с 1-Wire термометрами DS18B20
- Возможность работы с несколькими датчиками на одном пине при использовании 8-битного уникального адреса
- Возможность работы с одним датчиком на пине без использования адресации
- Настраиваемое разрешение преобразования
- Проверка подлинности данных "на лету", с использованием CRC8 от Dallas [#define DS_CHECK_CRC]
- Расчет CRC8 (~6 мкс) или чтение из таблицы (<1 мкс + 256 байт flash) [#define DS_CRC_USE_TABLE]
- Расчет температуры как в целых числах, так и с плавающей точкой [#define DS_TEMP_TYPE float / int]
- Чтение уникального адреса подключенного термометра в указанный массив типа byte

### Совместимость
Совместима со всеми Arduino платформами (используются Arduino-функции)

## Содержание
- [Установка](#install)
- [Инициализация](#init)
- [Использование](#usage)
- [Пример](#example)
- [Версии](#versions)
- [Баги и обратная связь](#feedback)

<a id="install"></a>
## Установка
- Библиотеку можно найти по названию **microDS18B20** и установить через менеджер библиотек в:
    - Arduino IDE
    - Arduino IDE v2
    - PlatformIO
- [Скачать библиотеку](https://github.com/GyverLibs/microDS18B20/archive/refs/heads/main.zip) .zip архивом для ручной установки:
    - Распаковать и положить в *C:\Program Files (x86)\Arduino\libraries* (Windows x64)
    - Распаковать и положить в *C:\Program Files\Arduino\libraries* (Windows x32)
    - Распаковать и положить в *Документы/Arduino/libraries/*
    - (Arduino IDE) автоматическая установка из .zip: *Скетч/Подключить библиотеку/Добавить .ZIP библиотеку…* и указать скачанный архив
- Читай более подробную инструкцию по установке библиотек [здесь](https://alexgyver.ru/arduino-first/#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA)

<a id="init"></a>
## Инициализация
```cpp
MicroDS18B20();
MicroDS18B20(uint8_t pin);                      // Создать обьект термометра без адресации
MicroDS18B20(uint8_t pin, uint8_t *address);    // Создать обьект термометра с адресацией
```

<a id="usage"></a>
## Использование
```cpp
void setResolution(uint8_t resolution);     // Установить разрешение термометра 9-12 бит
void readAddress(uint8_t *addressArray);    // Прочитать уникальный адрес термометра в массив
void setAddress(uint8_t *address);          // Установить адрес
void setPin(uint8_t pin);                   // Установить пин

void requestTemp(void);                     // Запросить новое преобразование температуры
float getTemp(void);                        // Прочитать значение температуры
int getTemp(void);                          // Прочитать значение температуры
// тип данных настраивается в библиотеке


// Время выполнения функций для работы с датчиком (частота ядра - 16 МГц):
_________________________________________________________________________________
| Датчик без адресации (один на линии) | Датчик с адресацией (несколько на линии) |
|______________________________________|__________________________________________|
| .setResolution(...) ~ 3591.125 мкс   | .setResolution(...) ~ 8276.0625 мкс 	  |
| .requestTemp() ~ 1839.9375 мкс	   | .requestTemp() ~ 6522.1875 мкс 		  |
|______________________________________|__________________________________________|
|							С использованием CRC8								  |
|_________________________________________________________________________________|
| .readAddress(...) ~ 6467.3125 мкс	   | float .getTemp() ~ 12250.25 мкс	 	  | 
| float .getTemp() ~ 7620.25 мкс	   | int .getTemp() ~ 12250.2500 мкс 		  |	
| int .getTemp() ~ 7574.0625 мкс	   | 									      |
|______________________________________|__________________________________________|
|							Без использования CRC8								  |
|_________________________________________________________________________________|
| .readAddress(...) ~ 6394.3125 мкс    | float .getTemp() ~ 7809.1250 мкс	 	  |
| float .getTemp() ~ 3132.9375 мкс	   | int .getTemp() ~ 7809.1250 мкс	 		  |
| int .getTemp() ~ 3132.9375 мкс	   | 								  		  |
|______________________________________|__________________________________________|
```

<a id="example"></a>
## Пример
Остальные примеры смотри в **examples**!
```cpp
#include <microDS18B20.h>

/*
  Опрос датчиков асинхронный, т.е. не блокирует выполнение кода, но
  между requestTemp и getTemp должно пройти не менее

  точность | время
  12 бит   | 750 мс
  11 бит   | 375 мс
  10 бит   | 187 мс
  9 бит    | 93 мс

  Иначе датчик вернёт предыдущее значение
  Используйте опрос по таймеру, delay это плохо
*/

#define SENSOR_PIN 9   // пин для термометра

MicroDS18B20 sensor(SENSOR_PIN);  // Создаем термометр без адресации

void setup() {
  Serial.begin(9600);

  // настройка разрешения (точности) датчика, 9-12 бит. По умолч. 12
  sensor.setResolution(12);
}

void loop() {
  sensor.requestTemp();             // Запрашиваем преобразование температуры

  delay(1000);                             // Ожидаем окончания преобразования (см. выше)

  Serial.print("Sensor temp: ");
  Serial.print(sensor.getTemp());  // Выводим температуру
  Serial.println(" *C");
}
```

<a id="versions"></a>
## Версии
- v2.2

<a id="feedback"></a>
## Баги и обратная связь
При нахождении багов создавайте **Issue**, а лучше сразу пишите на почту [alex@alexgyver.ru](mailto:alex@alexgyver.ru)  
Библиотека открыта для доработки и ваших **Pull Request**'ов!